<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Porolog::Goal
  
    &mdash; Documentation by YARD 0.9.19
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Porolog::Goal";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (G)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span>
     &raquo; 
    <span class="title">Goal</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Porolog::Goal
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Porolog::Goal</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/porolog/goal.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>A Porolog::Goal finds solutions for specific Arguments of a Predicate.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Author:</p>
<ul class="author">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>Luis Esteban</p>
</div>
      
    </li>
  
</ul>

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Goal/DefinitionError.html" title="Porolog::Goal::DefinitionError (class)">DefinitionError</a></span>, <span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span>, <span class='object_link'><a href="Goal/NotVariableError.html" title="Porolog::Goal::NotVariableError (class)">NotVariableError</a></span>
    
  
</p>




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#arguments-instance_method" title="#arguments (instance method)">#<strong>arguments</strong>  &#x21d2; Porolog::Arguments </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The specific Arguments this goal is trying to solve.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#calling_goal-instance_method" title="#calling_goal (instance method)">#<strong>calling_goal</strong>  &#x21d2; Porolog::Goal<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The parent goal if this goal is a subgoal, otherwise nil.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#description-instance_method" title="#description (instance method)">#<strong>description</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Description of the Arguments the Goal is attempting to solve.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#index-instance_method" title="#index (instance method)">#<strong>index</strong>  &#x21d2; Integer<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Solution index for builtin predicates.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#log-instance_method" title="#log (instance method)">#<strong>log</strong>  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Log of events, namely unification failures.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#result-instance_method" title="#result (instance method)">#<strong>result</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Whether any result has been found.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#goal_count-class_method" title="goal_count (class method)">.<strong>goal_count</strong>  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The number of goals created.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#goals-class_method" title="goals (class method)">.<strong>goals</strong>  &#x21d2; Array&lt;Porolog::Goal&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A convenience method for testing/debugging.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset-class_method" title="reset (class method)">.<strong>reset</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Clears all goals and ensures they are deleted.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ancestors-instance_method" title="#ancestors (instance method)">#<strong>ancestors</strong>  &#x21d2; Array&lt;Porolog::Goal&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The calling chain for this goal.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ancestry-instance_method" title="#ancestry (instance method)">#<strong>ancestry</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A convenience method for testing/debugging.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_deleted-instance_method" title="#check_deleted (instance method)">#<strong>check_deleted</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Determines whether the Goal has been deleted and removes its Variables and Values if it has.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete!-instance_method" title="#delete! (instance method)">#<strong>delete!</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delete the Goal.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deleted%3F-instance_method" title="#deleted? (instance method)">#<strong>deleted?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Whether the Goal has been deleted (memoized).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inherit_variables-instance_method" title="#inherit_variables (instance method)">#<strong>inherit_variables</strong>(other_goal = @calling_goal)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Inherits variables and their instantiations from another goal.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(arguments, calling_goal = nil)  &#x21d2; Goal </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initializes and registers the Goal.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect-instance_method" title="#inspect (instance method)">#<strong>inspect</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Pretty representation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#inspect_variables-instance_method" title="#inspect_variables (instance method)">#<strong>inspect_variables</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A convenience method for testing/debugging.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#instantiate-instance_method" title="#instantiate (instance method)">#<strong>instantiate</strong>(name, other, other_goal = self)  &#x21d2; Porolog::Instantiation </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Instantiates a Variable to another Variable or Value, for this Goal.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#myid-instance_method" title="#myid (instance method)">#<strong>myid</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A convenience method for testing/debugging.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#satisfy-instance_method" title="#satisfy (instance method)">#<strong>satisfy</strong>(&amp;block)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Solves the goal but not as the root goal for a query.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#solve-instance_method" title="#solve (instance method)">#<strong>solve</strong>(max_solutions = nil)  &#x21d2; Array&lt;Hash{Symbol =&gt; Object}&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finds all possible solutions to the Predicate for the specific Arguments.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#terminate!-instance_method" title="#terminate! (instance method)">#<strong>terminate!</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sets that the goal should no longer search any further rules for the current predicate once the current rule has finished being evaluated.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#terminated%3F-instance_method" title="#terminated? (instance method)">#<strong>terminated?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Whether the goal has been cut.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#value-instance_method" title="#value (instance method)">#<strong>value</strong>(value)  &#x21d2; Porolog::Value </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A Value, ensuring it has been associated with this Goal so that it can be uninstantiated.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#value_of-instance_method" title="#value_of (instance method)">#<strong>value_of</strong>(name, index = nil, visited = [])  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of the indicated variable or value.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#values-instance_method" title="#values (instance method)">#<strong>values</strong>  &#x21d2; Array&lt;Object&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A convenience method for testing/debugging.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#values_of-instance_method" title="#values_of (instance method)">#<strong>values_of</strong>(object)  &#x21d2; Object<sup>+</sup> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the values of an Object.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#variable-instance_method" title="#variable (instance method)">#<strong>variable</strong>(name)  &#x21d2; Porolog::Variable, Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finds or tries to create a variable in the goal (as much as possible) otherwise passes the parameter back.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#variables-instance_method" title="#variables (instance method)">#<strong>variables</strong>  &#x21d2; Hash{Symbol =&gt; Object} </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The Variables and their current values of this Goal.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#variablise-instance_method" title="#variablise (instance method)">#<strong>variablise</strong>(object)  &#x21d2; Object </a>
    

    
      (also: #[])
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Converts all embedded Symbols to Variables within this Goal.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(arguments, calling_goal = nil)  &#x21d2; <tt><span class='object_link'><a href="" title="Porolog::Goal (class)">Goal</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Initializes and registers the Goal.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>arguments</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Porolog::Arguments</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the Predicate Arguments that this Goal is to solve.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>calling_goal</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the parent Goal if this Goal is a subgoal.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='cvar'>@@goals</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
  <span class='cvar'>@@goal_count</span> <span class='op'>+=</span> <span class='int'>1</span>
  
  <span class='ivar'>@arguments</span>    <span class='op'>=</span> <span class='id identifier rubyid_arguments'>arguments</span>
  <span class='ivar'>@terminate</span>    <span class='op'>=</span> <span class='kw'>false</span>
  <span class='ivar'>@calling_goal</span> <span class='op'>=</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span>
  <span class='ivar'>@variables</span>    <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@values</span>       <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@result</span>       <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@description</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solve </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@log</span>          <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  
  <span class='ivar'>@arguments</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span><span class='rparen'>)</span>
  <span class='ivar'>@solutions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="arguments=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="arguments-instance_method">
  
    #<strong>arguments</strong>  &#x21d2; <tt><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Porolog::Arguments</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The specific Arguments this goal is trying to solve.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Porolog::Arguments</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The specific Arguments this goal is trying to solve.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 27</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="Porolog::Goal (class)">Goal</a></span></span>
  
  <span class='comment'># Error class for rescuing or detecting any Goal error.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>             <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="PorologError.html" title="Porolog::PorologError (class)">PorologError</a></span></span> <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating an unexpected type of Rule definition.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/DefinitionError.html" title="Porolog::Goal::DefinitionError (class)">DefinitionError</a></span></span>   <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating a non-Variable was attempted to be instantiated.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/NotVariableError.html" title="Porolog::Goal::NotVariableError (class)">NotVariableError</a></span></span>  <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  
  <span class='comment'># Clears all goals and ensures they are deleted.
</span>  <span class='comment'># @return [Boolean] success
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
    <span class='cvar'>@@goals</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goals'>goals</span> <span class='op'>=</span> <span class='cvar'>@@goals</span>
    <span class='cvar'>@@goals</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_goals'>goals</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:deleted?</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Integer] the number of goals created
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goal_count'>goal_count</span>
    <span class='cvar'>@@goal_count</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_reset'>reset</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:calling_goal</span><span class='comma'>,</span> <span class='symbol'>:arguments</span><span class='comma'>,</span> <span class='symbol'>:index</span><span class='comma'>,</span> <span class='symbol'>:result</span><span class='comma'>,</span> <span class='symbol'>:description</span><span class='comma'>,</span> <span class='symbol'>:log</span>
  
  <span class='comment'># Initializes and registers the Goal.
</span>  <span class='comment'># @param arguments [Porolog::Arguments] the Predicate Arguments that this Goal is to solve.
</span>  <span class='comment'># @param calling_goal [Porolog::Goal] the parent Goal if this Goal is a subgoal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='cvar'>@@goals</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>+=</span> <span class='int'>1</span>
    
    <span class='ivar'>@arguments</span>    <span class='op'>=</span> <span class='id identifier rubyid_arguments'>arguments</span>
    <span class='ivar'>@terminate</span>    <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@calling_goal</span> <span class='op'>=</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='ivar'>@variables</span>    <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@values</span>       <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@result</span>       <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@description</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solve </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@log</span>          <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    
    <span class='ivar'>@arguments</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span><span class='rparen'>)</span>
    <span class='ivar'>@solutions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;] the calling chain for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestors'>ancestors</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goal'>goal</span>      <span class='op'>=</span> <span class='kw'>self</span>
    
    <span class='kw'>while</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_goal'>goal</span> <span class='op'>=</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the calling chain for this goal as a String.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestry'>ancestry</span>
    <span class='id identifier rubyid_indent'>indent</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='id identifier rubyid_indent'>indent</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_indent'>indent</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the id of the goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_myid'>myid</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Goal</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>-</span><span class='int'>1000</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [String] pretty representation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;]
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goals'>goals</span>
    <span class='cvar'>@@goals</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Delete the Goal
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete!'>delete!</span>
    <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_deleted?'>deleted?</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_deleted?'>deleted?</span>
    <span class='ivar'>@deleted</span> <span class='op'>||=</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='ivar'>@deleted</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Determines whether the Goal has been deleted and removes its Variables and Values if it has.
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Sets that the goal should no longer search any further rules for the current predicate
</span>  <span class='comment'># once the current rule has finished being evaluated.
</span>  <span class='comment'># This method implements the :CUT rule.
</span>  <span class='comment'># That is, backtracking does not go back past the point of the cut.
</span>  <span class='comment'># @return [Boolean] true.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminate!'>terminate!</span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>terminating</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@terminate</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the goal has been cut.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminated?'>terminated?</span>
    <span class='ivar'>@terminate</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Converts all embedded Symbols to Variables within this Goal.
</span>  <span class='comment'># @param object [Object] the object to variablise.
</span>  <span class='comment'># @return [Object] the variablised object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span>
        <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Tail.html#initialize-instance_method" title="Porolog::Tail#initialize (method)">new</a></span></span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'>NilClass</span>
        <span class='kw'>nil</span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_TAIL-constant" title="Porolog::UNKNOWN_TAIL (constant)">UNKNOWN_TAIL</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_ARRAY-constant" title="Porolog::UNKNOWN_ARRAY (constant)">UNKNOWN_ARRAY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_object'>object</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>alias</span> <span class='op'>[]</span> <span class='id identifier rubyid_variablise'>variablise</span>
  
  <span class='comment'># @return [Hash{Symbol =&gt; Object}] the Variables and their current values of this Goal
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variables'>variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='comma'>,</span><span class='id identifier rubyid_variable_list'>variable_list</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_variable'>variable</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_clean'>clean</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] a tree representation of all the instantiations of this goal&#39;s variables.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect_with_instantiations</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Object&gt;] the values instantiated for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds or tries to create a variable in the goal (as much as possible) otherwise passes the parameter back.
</span>  <span class='comment'># @param name [Object] name of variable or variable
</span>  <span class='comment'># @return [Porolog::Variable, Object] a variable of the goal or the original parameter
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    
    <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
      <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span> <span class='kw'>if</span> <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_goal'>goal</span> <span class='op'>==</span> <span class='kw'>self</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_variable'>variable</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Variable.html#initialize-instance_method" title="Porolog::Variable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @param value [Object] the value that needs to be associated with this Goal.
</span>  <span class='comment'># @return [Porolog::Value] a Value, ensuring it has been associated with this Goal so that it can be uninstantiated.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Value.html#initialize-instance_method" title="Porolog::Value#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the value of the indicated variable or value
</span>  <span class='comment'># @param name [Symbol, Object] name of the variable or value
</span>  <span class='comment'># @param index [Object] index is not yet used
</span>  <span class='comment'># @param visited [Array] used to avoid infinite recursion
</span>  <span class='comment'># @return [Object] the value
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_visited'>visited</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the values of an Object.  For most objects, this will basically just be the object.
</span>  <span class='comment'># For Arrays, an Array will be returned where the elements are the value of the elements.
</span>  <span class='comment'># @param object [Object] the Object to find the values of.
</span>  <span class='comment'># @return [Object,Array&lt;Object&gt;] the value(s) of the object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='comment'># TODO: This needs to splat outwards; in the meantime, it splats just the first.
</span>        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds all possible solutions to the Predicate for the specific Arguments.
</span>  <span class='comment'># @param max_solutions [Integer] if provided, the search is stopped once the number of solutions has been found
</span>  <span class='comment'># @return [Array&lt;Hash{Symbol =&gt; Object}&gt;]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='comment'># TODO: Refactor to overrideable method (or another solution, say a lambda)
</span>      
      <span class='ivar'>@solutions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_variables'>variables</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOLUTION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variables'>variables</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_ancestry'>ancestry</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
      
      <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>if</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@solutions</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@solutions</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Solves the goal but not as the root goal for a query.
</span>  <span class='comment'># That is, solves an intermediate goal.
</span>  <span class='comment'># @param block [Proc] code to perform when the Goal is satisfied.
</span>  <span class='comment'># @return [Boolean] whether the definition was satisfied.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='op'>|</span>
      <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>||=</span> <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_satisfied'>satisfied</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Instantiates a Variable to another Variable or Value, for this Goal.
</span>  <span class='comment'># @param name [Symbol,Porolog::Variable,Object] the name that references the variable to be instantiated.
</span>  <span class='comment'># @param other [Object] the value that the variable is to be instantiated to.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal of the other value.
</span>  <span class='comment'># @return [Porolog::Instantiation] the instantiation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    
    <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:variable</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Inherits variables and their instantiations from another goal.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal to inherit variables from.
</span>  <span class='comment'># @return [Boolean] whether the variables could be inherited (unified).
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inherit_variables'>inherit_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='ivar'>@calling_goal</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other_goal'>other_goal</span>
    
    <span class='id identifier rubyid_unified'>unified</span>      <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_variables'>variables</span>    <span class='op'>=</span> <span class='lparen'>(</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span> <span class='op'>+</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>+</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    
    <span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span>
      
      <span class='id identifier rubyid_unification'>unification</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_unify'><span class='object_link'><a href="../Porolog.html#unify-instance_method" title="Porolog#unify (method)">unify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_unified'>unified</span>   <span class='op'>&amp;&amp;=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
        <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>+=</span> <span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>else</span>
        <span class='comment'>#:nocov:
</span>        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t unify: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> WITH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> AND </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>break</span>
        <span class='comment'>#:nocov:
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_unified'>unified</span> <span class='op'>&amp;&amp;=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_instantiate_unifications'><span class='object_link'><a href="../Porolog.html#instantiate_unifications-instance_method" title="Porolog#instantiate_unifications (method)">instantiate_unifications</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_unifications'>unifications</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
    
    <span class='id identifier rubyid_unified'>unified</span>
  <span class='kw'>end</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="calling_goal=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="calling_goal-instance_method">
  
    #<strong>calling_goal</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span></tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns The parent goal if this goal is a subgoal, otherwise nil.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span></tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The parent goal if this goal is a subgoal, otherwise nil.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 27</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="Porolog::Goal (class)">Goal</a></span></span>
  
  <span class='comment'># Error class for rescuing or detecting any Goal error.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>             <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="PorologError.html" title="Porolog::PorologError (class)">PorologError</a></span></span> <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating an unexpected type of Rule definition.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/DefinitionError.html" title="Porolog::Goal::DefinitionError (class)">DefinitionError</a></span></span>   <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating a non-Variable was attempted to be instantiated.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/NotVariableError.html" title="Porolog::Goal::NotVariableError (class)">NotVariableError</a></span></span>  <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  
  <span class='comment'># Clears all goals and ensures they are deleted.
</span>  <span class='comment'># @return [Boolean] success
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
    <span class='cvar'>@@goals</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goals'>goals</span> <span class='op'>=</span> <span class='cvar'>@@goals</span>
    <span class='cvar'>@@goals</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_goals'>goals</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:deleted?</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Integer] the number of goals created
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goal_count'>goal_count</span>
    <span class='cvar'>@@goal_count</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_reset'>reset</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:calling_goal</span><span class='comma'>,</span> <span class='symbol'>:arguments</span><span class='comma'>,</span> <span class='symbol'>:index</span><span class='comma'>,</span> <span class='symbol'>:result</span><span class='comma'>,</span> <span class='symbol'>:description</span><span class='comma'>,</span> <span class='symbol'>:log</span>
  
  <span class='comment'># Initializes and registers the Goal.
</span>  <span class='comment'># @param arguments [Porolog::Arguments] the Predicate Arguments that this Goal is to solve.
</span>  <span class='comment'># @param calling_goal [Porolog::Goal] the parent Goal if this Goal is a subgoal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='cvar'>@@goals</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>+=</span> <span class='int'>1</span>
    
    <span class='ivar'>@arguments</span>    <span class='op'>=</span> <span class='id identifier rubyid_arguments'>arguments</span>
    <span class='ivar'>@terminate</span>    <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@calling_goal</span> <span class='op'>=</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='ivar'>@variables</span>    <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@values</span>       <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@result</span>       <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@description</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solve </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@log</span>          <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    
    <span class='ivar'>@arguments</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span><span class='rparen'>)</span>
    <span class='ivar'>@solutions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;] the calling chain for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestors'>ancestors</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goal'>goal</span>      <span class='op'>=</span> <span class='kw'>self</span>
    
    <span class='kw'>while</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_goal'>goal</span> <span class='op'>=</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the calling chain for this goal as a String.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestry'>ancestry</span>
    <span class='id identifier rubyid_indent'>indent</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='id identifier rubyid_indent'>indent</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_indent'>indent</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the id of the goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_myid'>myid</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Goal</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>-</span><span class='int'>1000</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [String] pretty representation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;]
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goals'>goals</span>
    <span class='cvar'>@@goals</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Delete the Goal
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete!'>delete!</span>
    <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_deleted?'>deleted?</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_deleted?'>deleted?</span>
    <span class='ivar'>@deleted</span> <span class='op'>||=</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='ivar'>@deleted</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Determines whether the Goal has been deleted and removes its Variables and Values if it has.
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Sets that the goal should no longer search any further rules for the current predicate
</span>  <span class='comment'># once the current rule has finished being evaluated.
</span>  <span class='comment'># This method implements the :CUT rule.
</span>  <span class='comment'># That is, backtracking does not go back past the point of the cut.
</span>  <span class='comment'># @return [Boolean] true.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminate!'>terminate!</span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>terminating</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@terminate</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the goal has been cut.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminated?'>terminated?</span>
    <span class='ivar'>@terminate</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Converts all embedded Symbols to Variables within this Goal.
</span>  <span class='comment'># @param object [Object] the object to variablise.
</span>  <span class='comment'># @return [Object] the variablised object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span>
        <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Tail.html#initialize-instance_method" title="Porolog::Tail#initialize (method)">new</a></span></span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'>NilClass</span>
        <span class='kw'>nil</span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_TAIL-constant" title="Porolog::UNKNOWN_TAIL (constant)">UNKNOWN_TAIL</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_ARRAY-constant" title="Porolog::UNKNOWN_ARRAY (constant)">UNKNOWN_ARRAY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_object'>object</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>alias</span> <span class='op'>[]</span> <span class='id identifier rubyid_variablise'>variablise</span>
  
  <span class='comment'># @return [Hash{Symbol =&gt; Object}] the Variables and their current values of this Goal
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variables'>variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='comma'>,</span><span class='id identifier rubyid_variable_list'>variable_list</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_variable'>variable</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_clean'>clean</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] a tree representation of all the instantiations of this goal&#39;s variables.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect_with_instantiations</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Object&gt;] the values instantiated for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds or tries to create a variable in the goal (as much as possible) otherwise passes the parameter back.
</span>  <span class='comment'># @param name [Object] name of variable or variable
</span>  <span class='comment'># @return [Porolog::Variable, Object] a variable of the goal or the original parameter
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    
    <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
      <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span> <span class='kw'>if</span> <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_goal'>goal</span> <span class='op'>==</span> <span class='kw'>self</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_variable'>variable</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Variable.html#initialize-instance_method" title="Porolog::Variable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @param value [Object] the value that needs to be associated with this Goal.
</span>  <span class='comment'># @return [Porolog::Value] a Value, ensuring it has been associated with this Goal so that it can be uninstantiated.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Value.html#initialize-instance_method" title="Porolog::Value#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the value of the indicated variable or value
</span>  <span class='comment'># @param name [Symbol, Object] name of the variable or value
</span>  <span class='comment'># @param index [Object] index is not yet used
</span>  <span class='comment'># @param visited [Array] used to avoid infinite recursion
</span>  <span class='comment'># @return [Object] the value
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_visited'>visited</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the values of an Object.  For most objects, this will basically just be the object.
</span>  <span class='comment'># For Arrays, an Array will be returned where the elements are the value of the elements.
</span>  <span class='comment'># @param object [Object] the Object to find the values of.
</span>  <span class='comment'># @return [Object,Array&lt;Object&gt;] the value(s) of the object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='comment'># TODO: This needs to splat outwards; in the meantime, it splats just the first.
</span>        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds all possible solutions to the Predicate for the specific Arguments.
</span>  <span class='comment'># @param max_solutions [Integer] if provided, the search is stopped once the number of solutions has been found
</span>  <span class='comment'># @return [Array&lt;Hash{Symbol =&gt; Object}&gt;]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='comment'># TODO: Refactor to overrideable method (or another solution, say a lambda)
</span>      
      <span class='ivar'>@solutions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_variables'>variables</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOLUTION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variables'>variables</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_ancestry'>ancestry</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
      
      <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>if</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@solutions</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@solutions</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Solves the goal but not as the root goal for a query.
</span>  <span class='comment'># That is, solves an intermediate goal.
</span>  <span class='comment'># @param block [Proc] code to perform when the Goal is satisfied.
</span>  <span class='comment'># @return [Boolean] whether the definition was satisfied.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='op'>|</span>
      <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>||=</span> <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_satisfied'>satisfied</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Instantiates a Variable to another Variable or Value, for this Goal.
</span>  <span class='comment'># @param name [Symbol,Porolog::Variable,Object] the name that references the variable to be instantiated.
</span>  <span class='comment'># @param other [Object] the value that the variable is to be instantiated to.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal of the other value.
</span>  <span class='comment'># @return [Porolog::Instantiation] the instantiation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    
    <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:variable</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Inherits variables and their instantiations from another goal.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal to inherit variables from.
</span>  <span class='comment'># @return [Boolean] whether the variables could be inherited (unified).
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inherit_variables'>inherit_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='ivar'>@calling_goal</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other_goal'>other_goal</span>
    
    <span class='id identifier rubyid_unified'>unified</span>      <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_variables'>variables</span>    <span class='op'>=</span> <span class='lparen'>(</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span> <span class='op'>+</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>+</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    
    <span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span>
      
      <span class='id identifier rubyid_unification'>unification</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_unify'><span class='object_link'><a href="../Porolog.html#unify-instance_method" title="Porolog#unify (method)">unify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_unified'>unified</span>   <span class='op'>&amp;&amp;=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
        <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>+=</span> <span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>else</span>
        <span class='comment'>#:nocov:
</span>        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t unify: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> WITH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> AND </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>break</span>
        <span class='comment'>#:nocov:
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_unified'>unified</span> <span class='op'>&amp;&amp;=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_instantiate_unifications'><span class='object_link'><a href="../Porolog.html#instantiate_unifications-instance_method" title="Porolog#instantiate_unifications (method)">instantiate_unifications</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_unifications'>unifications</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
    
    <span class='id identifier rubyid_unified'>unified</span>
  <span class='kw'>end</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="description=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="description-instance_method">
  
    #<strong>description</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns Description of the Arguments the Goal is attempting to solve.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Description of the Arguments the Goal is attempting to solve.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 27</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="Porolog::Goal (class)">Goal</a></span></span>
  
  <span class='comment'># Error class for rescuing or detecting any Goal error.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>             <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="PorologError.html" title="Porolog::PorologError (class)">PorologError</a></span></span> <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating an unexpected type of Rule definition.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/DefinitionError.html" title="Porolog::Goal::DefinitionError (class)">DefinitionError</a></span></span>   <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating a non-Variable was attempted to be instantiated.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/NotVariableError.html" title="Porolog::Goal::NotVariableError (class)">NotVariableError</a></span></span>  <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  
  <span class='comment'># Clears all goals and ensures they are deleted.
</span>  <span class='comment'># @return [Boolean] success
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
    <span class='cvar'>@@goals</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goals'>goals</span> <span class='op'>=</span> <span class='cvar'>@@goals</span>
    <span class='cvar'>@@goals</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_goals'>goals</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:deleted?</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Integer] the number of goals created
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goal_count'>goal_count</span>
    <span class='cvar'>@@goal_count</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_reset'>reset</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:calling_goal</span><span class='comma'>,</span> <span class='symbol'>:arguments</span><span class='comma'>,</span> <span class='symbol'>:index</span><span class='comma'>,</span> <span class='symbol'>:result</span><span class='comma'>,</span> <span class='symbol'>:description</span><span class='comma'>,</span> <span class='symbol'>:log</span>
  
  <span class='comment'># Initializes and registers the Goal.
</span>  <span class='comment'># @param arguments [Porolog::Arguments] the Predicate Arguments that this Goal is to solve.
</span>  <span class='comment'># @param calling_goal [Porolog::Goal] the parent Goal if this Goal is a subgoal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='cvar'>@@goals</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>+=</span> <span class='int'>1</span>
    
    <span class='ivar'>@arguments</span>    <span class='op'>=</span> <span class='id identifier rubyid_arguments'>arguments</span>
    <span class='ivar'>@terminate</span>    <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@calling_goal</span> <span class='op'>=</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='ivar'>@variables</span>    <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@values</span>       <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@result</span>       <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@description</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solve </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@log</span>          <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    
    <span class='ivar'>@arguments</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span><span class='rparen'>)</span>
    <span class='ivar'>@solutions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;] the calling chain for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestors'>ancestors</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goal'>goal</span>      <span class='op'>=</span> <span class='kw'>self</span>
    
    <span class='kw'>while</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_goal'>goal</span> <span class='op'>=</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the calling chain for this goal as a String.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestry'>ancestry</span>
    <span class='id identifier rubyid_indent'>indent</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='id identifier rubyid_indent'>indent</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_indent'>indent</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the id of the goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_myid'>myid</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Goal</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>-</span><span class='int'>1000</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [String] pretty representation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;]
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goals'>goals</span>
    <span class='cvar'>@@goals</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Delete the Goal
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete!'>delete!</span>
    <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_deleted?'>deleted?</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_deleted?'>deleted?</span>
    <span class='ivar'>@deleted</span> <span class='op'>||=</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='ivar'>@deleted</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Determines whether the Goal has been deleted and removes its Variables and Values if it has.
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Sets that the goal should no longer search any further rules for the current predicate
</span>  <span class='comment'># once the current rule has finished being evaluated.
</span>  <span class='comment'># This method implements the :CUT rule.
</span>  <span class='comment'># That is, backtracking does not go back past the point of the cut.
</span>  <span class='comment'># @return [Boolean] true.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminate!'>terminate!</span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>terminating</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@terminate</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the goal has been cut.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminated?'>terminated?</span>
    <span class='ivar'>@terminate</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Converts all embedded Symbols to Variables within this Goal.
</span>  <span class='comment'># @param object [Object] the object to variablise.
</span>  <span class='comment'># @return [Object] the variablised object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span>
        <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Tail.html#initialize-instance_method" title="Porolog::Tail#initialize (method)">new</a></span></span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'>NilClass</span>
        <span class='kw'>nil</span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_TAIL-constant" title="Porolog::UNKNOWN_TAIL (constant)">UNKNOWN_TAIL</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_ARRAY-constant" title="Porolog::UNKNOWN_ARRAY (constant)">UNKNOWN_ARRAY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_object'>object</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>alias</span> <span class='op'>[]</span> <span class='id identifier rubyid_variablise'>variablise</span>
  
  <span class='comment'># @return [Hash{Symbol =&gt; Object}] the Variables and their current values of this Goal
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variables'>variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='comma'>,</span><span class='id identifier rubyid_variable_list'>variable_list</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_variable'>variable</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_clean'>clean</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] a tree representation of all the instantiations of this goal&#39;s variables.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect_with_instantiations</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Object&gt;] the values instantiated for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds or tries to create a variable in the goal (as much as possible) otherwise passes the parameter back.
</span>  <span class='comment'># @param name [Object] name of variable or variable
</span>  <span class='comment'># @return [Porolog::Variable, Object] a variable of the goal or the original parameter
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    
    <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
      <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span> <span class='kw'>if</span> <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_goal'>goal</span> <span class='op'>==</span> <span class='kw'>self</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_variable'>variable</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Variable.html#initialize-instance_method" title="Porolog::Variable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @param value [Object] the value that needs to be associated with this Goal.
</span>  <span class='comment'># @return [Porolog::Value] a Value, ensuring it has been associated with this Goal so that it can be uninstantiated.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Value.html#initialize-instance_method" title="Porolog::Value#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the value of the indicated variable or value
</span>  <span class='comment'># @param name [Symbol, Object] name of the variable or value
</span>  <span class='comment'># @param index [Object] index is not yet used
</span>  <span class='comment'># @param visited [Array] used to avoid infinite recursion
</span>  <span class='comment'># @return [Object] the value
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_visited'>visited</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the values of an Object.  For most objects, this will basically just be the object.
</span>  <span class='comment'># For Arrays, an Array will be returned where the elements are the value of the elements.
</span>  <span class='comment'># @param object [Object] the Object to find the values of.
</span>  <span class='comment'># @return [Object,Array&lt;Object&gt;] the value(s) of the object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='comment'># TODO: This needs to splat outwards; in the meantime, it splats just the first.
</span>        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds all possible solutions to the Predicate for the specific Arguments.
</span>  <span class='comment'># @param max_solutions [Integer] if provided, the search is stopped once the number of solutions has been found
</span>  <span class='comment'># @return [Array&lt;Hash{Symbol =&gt; Object}&gt;]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='comment'># TODO: Refactor to overrideable method (or another solution, say a lambda)
</span>      
      <span class='ivar'>@solutions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_variables'>variables</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOLUTION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variables'>variables</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_ancestry'>ancestry</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
      
      <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>if</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@solutions</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@solutions</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Solves the goal but not as the root goal for a query.
</span>  <span class='comment'># That is, solves an intermediate goal.
</span>  <span class='comment'># @param block [Proc] code to perform when the Goal is satisfied.
</span>  <span class='comment'># @return [Boolean] whether the definition was satisfied.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='op'>|</span>
      <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>||=</span> <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_satisfied'>satisfied</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Instantiates a Variable to another Variable or Value, for this Goal.
</span>  <span class='comment'># @param name [Symbol,Porolog::Variable,Object] the name that references the variable to be instantiated.
</span>  <span class='comment'># @param other [Object] the value that the variable is to be instantiated to.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal of the other value.
</span>  <span class='comment'># @return [Porolog::Instantiation] the instantiation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    
    <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:variable</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Inherits variables and their instantiations from another goal.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal to inherit variables from.
</span>  <span class='comment'># @return [Boolean] whether the variables could be inherited (unified).
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inherit_variables'>inherit_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='ivar'>@calling_goal</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other_goal'>other_goal</span>
    
    <span class='id identifier rubyid_unified'>unified</span>      <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_variables'>variables</span>    <span class='op'>=</span> <span class='lparen'>(</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span> <span class='op'>+</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>+</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    
    <span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span>
      
      <span class='id identifier rubyid_unification'>unification</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_unify'><span class='object_link'><a href="../Porolog.html#unify-instance_method" title="Porolog#unify (method)">unify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_unified'>unified</span>   <span class='op'>&amp;&amp;=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
        <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>+=</span> <span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>else</span>
        <span class='comment'>#:nocov:
</span>        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t unify: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> WITH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> AND </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>break</span>
        <span class='comment'>#:nocov:
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_unified'>unified</span> <span class='op'>&amp;&amp;=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_instantiate_unifications'><span class='object_link'><a href="../Porolog.html#instantiate_unifications-instance_method" title="Porolog#instantiate_unifications (method)">instantiate_unifications</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_unifications'>unifications</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
    
    <span class='id identifier rubyid_unified'>unified</span>
  <span class='kw'>end</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="index=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="index-instance_method">
  
    #<strong>index</strong>  &#x21d2; <tt>Integer</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns Solution index for builtin predicates.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Solution index for builtin predicates.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 27</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="Porolog::Goal (class)">Goal</a></span></span>
  
  <span class='comment'># Error class for rescuing or detecting any Goal error.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>             <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="PorologError.html" title="Porolog::PorologError (class)">PorologError</a></span></span> <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating an unexpected type of Rule definition.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/DefinitionError.html" title="Porolog::Goal::DefinitionError (class)">DefinitionError</a></span></span>   <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating a non-Variable was attempted to be instantiated.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/NotVariableError.html" title="Porolog::Goal::NotVariableError (class)">NotVariableError</a></span></span>  <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  
  <span class='comment'># Clears all goals and ensures they are deleted.
</span>  <span class='comment'># @return [Boolean] success
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
    <span class='cvar'>@@goals</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goals'>goals</span> <span class='op'>=</span> <span class='cvar'>@@goals</span>
    <span class='cvar'>@@goals</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_goals'>goals</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:deleted?</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Integer] the number of goals created
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goal_count'>goal_count</span>
    <span class='cvar'>@@goal_count</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_reset'>reset</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:calling_goal</span><span class='comma'>,</span> <span class='symbol'>:arguments</span><span class='comma'>,</span> <span class='symbol'>:index</span><span class='comma'>,</span> <span class='symbol'>:result</span><span class='comma'>,</span> <span class='symbol'>:description</span><span class='comma'>,</span> <span class='symbol'>:log</span>
  
  <span class='comment'># Initializes and registers the Goal.
</span>  <span class='comment'># @param arguments [Porolog::Arguments] the Predicate Arguments that this Goal is to solve.
</span>  <span class='comment'># @param calling_goal [Porolog::Goal] the parent Goal if this Goal is a subgoal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='cvar'>@@goals</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>+=</span> <span class='int'>1</span>
    
    <span class='ivar'>@arguments</span>    <span class='op'>=</span> <span class='id identifier rubyid_arguments'>arguments</span>
    <span class='ivar'>@terminate</span>    <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@calling_goal</span> <span class='op'>=</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='ivar'>@variables</span>    <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@values</span>       <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@result</span>       <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@description</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solve </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@log</span>          <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    
    <span class='ivar'>@arguments</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span><span class='rparen'>)</span>
    <span class='ivar'>@solutions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;] the calling chain for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestors'>ancestors</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goal'>goal</span>      <span class='op'>=</span> <span class='kw'>self</span>
    
    <span class='kw'>while</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_goal'>goal</span> <span class='op'>=</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the calling chain for this goal as a String.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestry'>ancestry</span>
    <span class='id identifier rubyid_indent'>indent</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='id identifier rubyid_indent'>indent</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_indent'>indent</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the id of the goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_myid'>myid</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Goal</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>-</span><span class='int'>1000</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [String] pretty representation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;]
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goals'>goals</span>
    <span class='cvar'>@@goals</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Delete the Goal
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete!'>delete!</span>
    <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_deleted?'>deleted?</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_deleted?'>deleted?</span>
    <span class='ivar'>@deleted</span> <span class='op'>||=</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='ivar'>@deleted</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Determines whether the Goal has been deleted and removes its Variables and Values if it has.
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Sets that the goal should no longer search any further rules for the current predicate
</span>  <span class='comment'># once the current rule has finished being evaluated.
</span>  <span class='comment'># This method implements the :CUT rule.
</span>  <span class='comment'># That is, backtracking does not go back past the point of the cut.
</span>  <span class='comment'># @return [Boolean] true.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminate!'>terminate!</span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>terminating</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@terminate</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the goal has been cut.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminated?'>terminated?</span>
    <span class='ivar'>@terminate</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Converts all embedded Symbols to Variables within this Goal.
</span>  <span class='comment'># @param object [Object] the object to variablise.
</span>  <span class='comment'># @return [Object] the variablised object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span>
        <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Tail.html#initialize-instance_method" title="Porolog::Tail#initialize (method)">new</a></span></span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'>NilClass</span>
        <span class='kw'>nil</span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_TAIL-constant" title="Porolog::UNKNOWN_TAIL (constant)">UNKNOWN_TAIL</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_ARRAY-constant" title="Porolog::UNKNOWN_ARRAY (constant)">UNKNOWN_ARRAY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_object'>object</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>alias</span> <span class='op'>[]</span> <span class='id identifier rubyid_variablise'>variablise</span>
  
  <span class='comment'># @return [Hash{Symbol =&gt; Object}] the Variables and their current values of this Goal
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variables'>variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='comma'>,</span><span class='id identifier rubyid_variable_list'>variable_list</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_variable'>variable</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_clean'>clean</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] a tree representation of all the instantiations of this goal&#39;s variables.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect_with_instantiations</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Object&gt;] the values instantiated for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds or tries to create a variable in the goal (as much as possible) otherwise passes the parameter back.
</span>  <span class='comment'># @param name [Object] name of variable or variable
</span>  <span class='comment'># @return [Porolog::Variable, Object] a variable of the goal or the original parameter
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    
    <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
      <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span> <span class='kw'>if</span> <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_goal'>goal</span> <span class='op'>==</span> <span class='kw'>self</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_variable'>variable</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Variable.html#initialize-instance_method" title="Porolog::Variable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @param value [Object] the value that needs to be associated with this Goal.
</span>  <span class='comment'># @return [Porolog::Value] a Value, ensuring it has been associated with this Goal so that it can be uninstantiated.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Value.html#initialize-instance_method" title="Porolog::Value#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the value of the indicated variable or value
</span>  <span class='comment'># @param name [Symbol, Object] name of the variable or value
</span>  <span class='comment'># @param index [Object] index is not yet used
</span>  <span class='comment'># @param visited [Array] used to avoid infinite recursion
</span>  <span class='comment'># @return [Object] the value
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_visited'>visited</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the values of an Object.  For most objects, this will basically just be the object.
</span>  <span class='comment'># For Arrays, an Array will be returned where the elements are the value of the elements.
</span>  <span class='comment'># @param object [Object] the Object to find the values of.
</span>  <span class='comment'># @return [Object,Array&lt;Object&gt;] the value(s) of the object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='comment'># TODO: This needs to splat outwards; in the meantime, it splats just the first.
</span>        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds all possible solutions to the Predicate for the specific Arguments.
</span>  <span class='comment'># @param max_solutions [Integer] if provided, the search is stopped once the number of solutions has been found
</span>  <span class='comment'># @return [Array&lt;Hash{Symbol =&gt; Object}&gt;]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='comment'># TODO: Refactor to overrideable method (or another solution, say a lambda)
</span>      
      <span class='ivar'>@solutions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_variables'>variables</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOLUTION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variables'>variables</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_ancestry'>ancestry</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
      
      <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>if</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@solutions</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@solutions</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Solves the goal but not as the root goal for a query.
</span>  <span class='comment'># That is, solves an intermediate goal.
</span>  <span class='comment'># @param block [Proc] code to perform when the Goal is satisfied.
</span>  <span class='comment'># @return [Boolean] whether the definition was satisfied.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='op'>|</span>
      <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>||=</span> <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_satisfied'>satisfied</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Instantiates a Variable to another Variable or Value, for this Goal.
</span>  <span class='comment'># @param name [Symbol,Porolog::Variable,Object] the name that references the variable to be instantiated.
</span>  <span class='comment'># @param other [Object] the value that the variable is to be instantiated to.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal of the other value.
</span>  <span class='comment'># @return [Porolog::Instantiation] the instantiation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    
    <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:variable</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Inherits variables and their instantiations from another goal.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal to inherit variables from.
</span>  <span class='comment'># @return [Boolean] whether the variables could be inherited (unified).
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inherit_variables'>inherit_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='ivar'>@calling_goal</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other_goal'>other_goal</span>
    
    <span class='id identifier rubyid_unified'>unified</span>      <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_variables'>variables</span>    <span class='op'>=</span> <span class='lparen'>(</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span> <span class='op'>+</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>+</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    
    <span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span>
      
      <span class='id identifier rubyid_unification'>unification</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_unify'><span class='object_link'><a href="../Porolog.html#unify-instance_method" title="Porolog#unify (method)">unify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_unified'>unified</span>   <span class='op'>&amp;&amp;=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
        <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>+=</span> <span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>else</span>
        <span class='comment'>#:nocov:
</span>        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t unify: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> WITH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> AND </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>break</span>
        <span class='comment'>#:nocov:
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_unified'>unified</span> <span class='op'>&amp;&amp;=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_instantiate_unifications'><span class='object_link'><a href="../Porolog.html#instantiate_unifications-instance_method" title="Porolog#instantiate_unifications (method)">instantiate_unifications</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_unifications'>unifications</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
    
    <span class='id identifier rubyid_unified'>unified</span>
  <span class='kw'>end</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="log=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="log-instance_method">
  
    #<strong>log</strong>  &#x21d2; <tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns Log of events, namely unification failures.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Log of events, namely unification failures.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 27</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="Porolog::Goal (class)">Goal</a></span></span>
  
  <span class='comment'># Error class for rescuing or detecting any Goal error.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>             <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="PorologError.html" title="Porolog::PorologError (class)">PorologError</a></span></span> <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating an unexpected type of Rule definition.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/DefinitionError.html" title="Porolog::Goal::DefinitionError (class)">DefinitionError</a></span></span>   <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating a non-Variable was attempted to be instantiated.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/NotVariableError.html" title="Porolog::Goal::NotVariableError (class)">NotVariableError</a></span></span>  <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  
  <span class='comment'># Clears all goals and ensures they are deleted.
</span>  <span class='comment'># @return [Boolean] success
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
    <span class='cvar'>@@goals</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goals'>goals</span> <span class='op'>=</span> <span class='cvar'>@@goals</span>
    <span class='cvar'>@@goals</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_goals'>goals</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:deleted?</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Integer] the number of goals created
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goal_count'>goal_count</span>
    <span class='cvar'>@@goal_count</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_reset'>reset</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:calling_goal</span><span class='comma'>,</span> <span class='symbol'>:arguments</span><span class='comma'>,</span> <span class='symbol'>:index</span><span class='comma'>,</span> <span class='symbol'>:result</span><span class='comma'>,</span> <span class='symbol'>:description</span><span class='comma'>,</span> <span class='symbol'>:log</span>
  
  <span class='comment'># Initializes and registers the Goal.
</span>  <span class='comment'># @param arguments [Porolog::Arguments] the Predicate Arguments that this Goal is to solve.
</span>  <span class='comment'># @param calling_goal [Porolog::Goal] the parent Goal if this Goal is a subgoal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='cvar'>@@goals</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>+=</span> <span class='int'>1</span>
    
    <span class='ivar'>@arguments</span>    <span class='op'>=</span> <span class='id identifier rubyid_arguments'>arguments</span>
    <span class='ivar'>@terminate</span>    <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@calling_goal</span> <span class='op'>=</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='ivar'>@variables</span>    <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@values</span>       <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@result</span>       <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@description</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solve </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@log</span>          <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    
    <span class='ivar'>@arguments</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span><span class='rparen'>)</span>
    <span class='ivar'>@solutions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;] the calling chain for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestors'>ancestors</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goal'>goal</span>      <span class='op'>=</span> <span class='kw'>self</span>
    
    <span class='kw'>while</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_goal'>goal</span> <span class='op'>=</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the calling chain for this goal as a String.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestry'>ancestry</span>
    <span class='id identifier rubyid_indent'>indent</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='id identifier rubyid_indent'>indent</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_indent'>indent</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the id of the goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_myid'>myid</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Goal</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>-</span><span class='int'>1000</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [String] pretty representation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;]
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goals'>goals</span>
    <span class='cvar'>@@goals</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Delete the Goal
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete!'>delete!</span>
    <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_deleted?'>deleted?</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_deleted?'>deleted?</span>
    <span class='ivar'>@deleted</span> <span class='op'>||=</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='ivar'>@deleted</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Determines whether the Goal has been deleted and removes its Variables and Values if it has.
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Sets that the goal should no longer search any further rules for the current predicate
</span>  <span class='comment'># once the current rule has finished being evaluated.
</span>  <span class='comment'># This method implements the :CUT rule.
</span>  <span class='comment'># That is, backtracking does not go back past the point of the cut.
</span>  <span class='comment'># @return [Boolean] true.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminate!'>terminate!</span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>terminating</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@terminate</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the goal has been cut.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminated?'>terminated?</span>
    <span class='ivar'>@terminate</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Converts all embedded Symbols to Variables within this Goal.
</span>  <span class='comment'># @param object [Object] the object to variablise.
</span>  <span class='comment'># @return [Object] the variablised object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span>
        <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Tail.html#initialize-instance_method" title="Porolog::Tail#initialize (method)">new</a></span></span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'>NilClass</span>
        <span class='kw'>nil</span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_TAIL-constant" title="Porolog::UNKNOWN_TAIL (constant)">UNKNOWN_TAIL</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_ARRAY-constant" title="Porolog::UNKNOWN_ARRAY (constant)">UNKNOWN_ARRAY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_object'>object</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>alias</span> <span class='op'>[]</span> <span class='id identifier rubyid_variablise'>variablise</span>
  
  <span class='comment'># @return [Hash{Symbol =&gt; Object}] the Variables and their current values of this Goal
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variables'>variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='comma'>,</span><span class='id identifier rubyid_variable_list'>variable_list</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_variable'>variable</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_clean'>clean</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] a tree representation of all the instantiations of this goal&#39;s variables.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect_with_instantiations</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Object&gt;] the values instantiated for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds or tries to create a variable in the goal (as much as possible) otherwise passes the parameter back.
</span>  <span class='comment'># @param name [Object] name of variable or variable
</span>  <span class='comment'># @return [Porolog::Variable, Object] a variable of the goal or the original parameter
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    
    <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
      <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span> <span class='kw'>if</span> <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_goal'>goal</span> <span class='op'>==</span> <span class='kw'>self</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_variable'>variable</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Variable.html#initialize-instance_method" title="Porolog::Variable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @param value [Object] the value that needs to be associated with this Goal.
</span>  <span class='comment'># @return [Porolog::Value] a Value, ensuring it has been associated with this Goal so that it can be uninstantiated.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Value.html#initialize-instance_method" title="Porolog::Value#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the value of the indicated variable or value
</span>  <span class='comment'># @param name [Symbol, Object] name of the variable or value
</span>  <span class='comment'># @param index [Object] index is not yet used
</span>  <span class='comment'># @param visited [Array] used to avoid infinite recursion
</span>  <span class='comment'># @return [Object] the value
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_visited'>visited</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the values of an Object.  For most objects, this will basically just be the object.
</span>  <span class='comment'># For Arrays, an Array will be returned where the elements are the value of the elements.
</span>  <span class='comment'># @param object [Object] the Object to find the values of.
</span>  <span class='comment'># @return [Object,Array&lt;Object&gt;] the value(s) of the object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='comment'># TODO: This needs to splat outwards; in the meantime, it splats just the first.
</span>        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds all possible solutions to the Predicate for the specific Arguments.
</span>  <span class='comment'># @param max_solutions [Integer] if provided, the search is stopped once the number of solutions has been found
</span>  <span class='comment'># @return [Array&lt;Hash{Symbol =&gt; Object}&gt;]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='comment'># TODO: Refactor to overrideable method (or another solution, say a lambda)
</span>      
      <span class='ivar'>@solutions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_variables'>variables</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOLUTION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variables'>variables</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_ancestry'>ancestry</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
      
      <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>if</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@solutions</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@solutions</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Solves the goal but not as the root goal for a query.
</span>  <span class='comment'># That is, solves an intermediate goal.
</span>  <span class='comment'># @param block [Proc] code to perform when the Goal is satisfied.
</span>  <span class='comment'># @return [Boolean] whether the definition was satisfied.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='op'>|</span>
      <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>||=</span> <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_satisfied'>satisfied</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Instantiates a Variable to another Variable or Value, for this Goal.
</span>  <span class='comment'># @param name [Symbol,Porolog::Variable,Object] the name that references the variable to be instantiated.
</span>  <span class='comment'># @param other [Object] the value that the variable is to be instantiated to.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal of the other value.
</span>  <span class='comment'># @return [Porolog::Instantiation] the instantiation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    
    <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:variable</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Inherits variables and their instantiations from another goal.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal to inherit variables from.
</span>  <span class='comment'># @return [Boolean] whether the variables could be inherited (unified).
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inherit_variables'>inherit_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='ivar'>@calling_goal</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other_goal'>other_goal</span>
    
    <span class='id identifier rubyid_unified'>unified</span>      <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_variables'>variables</span>    <span class='op'>=</span> <span class='lparen'>(</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span> <span class='op'>+</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>+</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    
    <span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span>
      
      <span class='id identifier rubyid_unification'>unification</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_unify'><span class='object_link'><a href="../Porolog.html#unify-instance_method" title="Porolog#unify (method)">unify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_unified'>unified</span>   <span class='op'>&amp;&amp;=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
        <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>+=</span> <span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>else</span>
        <span class='comment'>#:nocov:
</span>        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t unify: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> WITH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> AND </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>break</span>
        <span class='comment'>#:nocov:
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_unified'>unified</span> <span class='op'>&amp;&amp;=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_instantiate_unifications'><span class='object_link'><a href="../Porolog.html#instantiate_unifications-instance_method" title="Porolog#instantiate_unifications (method)">instantiate_unifications</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_unifications'>unifications</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
    
    <span class='id identifier rubyid_unified'>unified</span>
  <span class='kw'>end</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="result=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="result-instance_method">
  
    #<strong>result</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns Whether any result has been found.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Whether any result has been found.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 27</span>

<span class='kw'>class</span> <span class='const'><span class='object_link'><a href="" title="Porolog::Goal (class)">Goal</a></span></span>
  
  <span class='comment'># Error class for rescuing or detecting any Goal error.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>             <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="PorologError.html" title="Porolog::PorologError (class)">PorologError</a></span></span> <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating an unexpected type of Rule definition.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/DefinitionError.html" title="Porolog::Goal::DefinitionError (class)">DefinitionError</a></span></span>   <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  <span class='comment'># Error class indicating a non-Variable was attempted to be instantiated.
</span>  <span class='kw'>class</span> <span class='const'><span class='object_link'><a href="Goal/NotVariableError.html" title="Porolog::Goal::NotVariableError (class)">NotVariableError</a></span></span>  <span class='op'>&lt;</span> <span class='const'><span class='object_link'><a href="Goal/Error.html" title="Porolog::Goal::Error (class)">Error</a></span></span>        <span class='semicolon'>;</span> <span class='kw'>end</span>
  
  <span class='comment'># Clears all goals and ensures they are deleted.
</span>  <span class='comment'># @return [Boolean] success
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
    <span class='cvar'>@@goals</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goals'>goals</span> <span class='op'>=</span> <span class='cvar'>@@goals</span>
    <span class='cvar'>@@goals</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_goals'>goals</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:deleted?</span><span class='rparen'>)</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Integer] the number of goals created
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goal_count'>goal_count</span>
    <span class='cvar'>@@goal_count</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_reset'>reset</span>
  
  <span class='id identifier rubyid_attr_accessor'>attr_accessor</span> <span class='symbol'>:calling_goal</span><span class='comma'>,</span> <span class='symbol'>:arguments</span><span class='comma'>,</span> <span class='symbol'>:index</span><span class='comma'>,</span> <span class='symbol'>:result</span><span class='comma'>,</span> <span class='symbol'>:description</span><span class='comma'>,</span> <span class='symbol'>:log</span>
  
  <span class='comment'># Initializes and registers the Goal.
</span>  <span class='comment'># @param arguments [Porolog::Arguments] the Predicate Arguments that this Goal is to solve.
</span>  <span class='comment'># @param calling_goal [Porolog::Goal] the parent Goal if this Goal is a subgoal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_arguments'>arguments</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='cvar'>@@goals</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span>
    <span class='cvar'>@@goal_count</span> <span class='op'>+=</span> <span class='int'>1</span>
    
    <span class='ivar'>@arguments</span>    <span class='op'>=</span> <span class='id identifier rubyid_arguments'>arguments</span>
    <span class='ivar'>@terminate</span>    <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@calling_goal</span> <span class='op'>=</span> <span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='ivar'>@variables</span>    <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@values</span>       <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@result</span>       <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@description</span>  <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Solve </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@log</span>          <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    
    <span class='ivar'>@arguments</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span><span class='rparen'>)</span>
    <span class='ivar'>@solutions</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;] the calling chain for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestors'>ancestors</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_goal'>goal</span>      <span class='op'>=</span> <span class='kw'>self</span>
    
    <span class='kw'>while</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span>
      <span class='id identifier rubyid_goal'>goal</span> <span class='op'>=</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_calling_goal'>calling_goal</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the calling chain for this goal as a String.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_ancestry'>ancestry</span>
    <span class='id identifier rubyid_indent'>indent</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='id identifier rubyid_indent'>indent</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_indent'>indent</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] the id of the goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_myid'>myid</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Goal</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>-</span><span class='int'>1000</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [String] pretty representation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Porolog::Goal&gt;]
</span>  <span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goals'>goals</span>
    <span class='cvar'>@@goals</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Delete the Goal
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_delete!'>delete!</span>
    <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_deleted?'>deleted?</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the Goal has been deleted (memoized)
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_deleted?'>deleted?</span>
    <span class='ivar'>@deleted</span> <span class='op'>||=</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='ivar'>@deleted</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Determines whether the Goal has been deleted and removes its Variables and Values if it has.
</span>  <span class='comment'># @return [Boolean] whether the Goal has been deleted
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
      <span class='kw'>true</span>
    <span class='kw'>end</span>
    
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Sets that the goal should no longer search any further rules for the current predicate
</span>  <span class='comment'># once the current rule has finished being evaluated.
</span>  <span class='comment'># This method implements the :CUT rule.
</span>  <span class='comment'># That is, backtracking does not go back past the point of the cut.
</span>  <span class='comment'># @return [Boolean] true.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminate!'>terminate!</span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>terminating</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@terminate</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @return [Boolean] whether the goal has been cut.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_terminated?'>terminated?</span>
    <span class='ivar'>@terminate</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Converts all embedded Symbols to Variables within this Goal.
</span>  <span class='comment'># @param object [Object] the object to variablise.
</span>  <span class='comment'># @return [Object] the variablised object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span>
        <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Tail.html#initialize-instance_method" title="Porolog::Tail#initialize (method)">new</a></span></span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'>NilClass</span>
        <span class='kw'>nil</span>
      <span class='kw'>else</span>
        <span class='kw'>if</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_TAIL-constant" title="Porolog::UNKNOWN_TAIL (constant)">UNKNOWN_TAIL</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_ARRAY-constant" title="Porolog::UNKNOWN_ARRAY (constant)">UNKNOWN_ARRAY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_object'>object</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>alias</span> <span class='op'>[]</span> <span class='id identifier rubyid_variablise'>variablise</span>
  
  <span class='comment'># @return [Hash{Symbol =&gt; Object}] the Variables and their current values of this Goal
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variables'>variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='comma'>,</span><span class='id identifier rubyid_variable_list'>variable_list</span><span class='op'>|</span>
      <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_variable'>variable</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_clean'>clean</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
      <span class='kw'>end</span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [String] a tree representation of all the instantiations of this goal&#39;s variables.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
    <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect_with_instantiations</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># A convenience method for testing/debugging.
</span>  <span class='comment'># @return [Array&lt;Object&gt;] the values instantiated for this goal.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
    <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds or tries to create a variable in the goal (as much as possible) otherwise passes the parameter back.
</span>  <span class='comment'># @param name [Object] name of variable or variable
</span>  <span class='comment'># @return [Porolog::Variable, Object] a variable of the goal or the original parameter
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    
    <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
      <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span> <span class='kw'>if</span> <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_goal'>goal</span> <span class='op'>==</span> <span class='kw'>self</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_variable'>variable</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Variable.html#initialize-instance_method" title="Porolog::Variable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># @param value [Object] the value that needs to be associated with this Goal.
</span>  <span class='comment'># @return [Porolog::Value] a Value, ensuring it has been associated with this Goal so that it can be uninstantiated.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Value.html#initialize-instance_method" title="Porolog::Value#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the value of the indicated variable or value
</span>  <span class='comment'># @param name [Symbol, Object] name of the variable or value
</span>  <span class='comment'># @param index [Object] index is not yet used
</span>  <span class='comment'># @param visited [Array] used to avoid infinite recursion
</span>  <span class='comment'># @return [Object] the value
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_visited'>visited</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Returns the values of an Object.  For most objects, this will basically just be the object.
</span>  <span class='comment'># For Arrays, an Array will be returned where the elements are the value of the elements.
</span>  <span class='comment'># @param object [Object] the Object to find the values of.
</span>  <span class='comment'># @return [Object,Array&lt;Object&gt;] the value(s) of the object.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
        <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
        <span class='comment'># TODO: This needs to splat outwards; in the meantime, it splats just the first.
</span>        <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Finds all possible solutions to the Predicate for the specific Arguments.
</span>  <span class='comment'># @param max_solutions [Integer] if provided, the search is stopped once the number of solutions has been found
</span>  <span class='comment'># @return [Array&lt;Hash{Symbol =&gt; Object}&gt;]
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
      <span class='comment'># TODO: Refactor to overrideable method (or another solution, say a lambda)
</span>      
      <span class='ivar'>@solutions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_variables'>variables</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOLUTION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variables'>variables</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_ancestry'>ancestry</span>
      <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
      
      <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>if</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@solutions</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span>
    <span class='kw'>end</span>
    
    <span class='ivar'>@solutions</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Solves the goal but not as the root goal for a query.
</span>  <span class='comment'># That is, solves an intermediate goal.
</span>  <span class='comment'># @param block [Proc] code to perform when the Goal is satisfied.
</span>  <span class='comment'># @return [Boolean] whether the definition was satisfied.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
    
    <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
    
    <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='op'>|</span>
      <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>||=</span> <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_satisfied'>satisfied</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Instantiates a Variable to another Variable or Value, for this Goal.
</span>  <span class='comment'># @param name [Symbol,Porolog::Variable,Object] the name that references the variable to be instantiated.
</span>  <span class='comment'># @param other [Object] the value that the variable is to be instantiated to.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal of the other value.
</span>  <span class='comment'># @return [Porolog::Instantiation] the instantiation.
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
    
    <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:variable</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    
    <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='comment'># Inherits variables and their instantiations from another goal.
</span>  <span class='comment'># @param other_goal [Porolog::Goal,nil] the Goal to inherit variables from.
</span>  <span class='comment'># @return [Boolean] whether the variables could be inherited (unified).
</span>  <span class='kw'>def</span> <span class='id identifier rubyid_inherit_variables'>inherit_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='ivar'>@calling_goal</span><span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other_goal'>other_goal</span>
    
    <span class='id identifier rubyid_unified'>unified</span>      <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_variables'>variables</span>    <span class='op'>=</span> <span class='lparen'>(</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span> <span class='op'>+</span>
      <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>+</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span>
    <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
    
    <span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
      <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span>
      
      <span class='id identifier rubyid_unification'>unification</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_unify'><span class='object_link'><a href="../Porolog.html#unify-instance_method" title="Porolog#unify (method)">unify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_unified'>unified</span>   <span class='op'>&amp;&amp;=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
        <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>+=</span> <span class='id identifier rubyid_unification'>unification</span>
      <span class='kw'>else</span>
        <span class='comment'>#:nocov:
</span>        <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t unify: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> WITH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> AND </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>break</span>
        <span class='comment'>#:nocov:
</span>      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_unified'>unified</span> <span class='op'>&amp;&amp;=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_instantiate_unifications'><span class='object_link'><a href="../Porolog.html#instantiate_unifications-instance_method" title="Porolog#instantiate_unifications (method)">instantiate_unifications</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_unifications'>unifications</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
    
    <span class='id identifier rubyid_unified'>unified</span>
  <span class='kw'>end</span>
  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="goal_count-class_method">
  
    .<strong>goal_count</strong>  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the number of goals created</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the number of goals created</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 48</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goal_count'>goal_count</span>
  <span class='cvar'>@@goal_count</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="goals-class_method">
  
    .<strong>goals</strong>  &#x21d2; <tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A convenience method for testing/debugging.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 112</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_goals'>goals</span>
  <span class='cvar'>@@goals</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset-class_method">
  
    .<strong>reset</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Clears all goals and ensures they are deleted.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>success</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41
42
43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 38</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
  <span class='cvar'>@@goals</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_goals'>goals</span> <span class='op'>=</span> <span class='cvar'>@@goals</span>
  <span class='cvar'>@@goals</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='cvar'>@@goal_count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_goals'>goals</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:deleted?</span><span class='rparen'>)</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="ancestors-instance_method">
  
    #<strong>ancestors</strong>  &#x21d2; <tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the calling chain for this goal.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the calling chain for this goal.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


77
78
79
80
81
82
83
84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 77</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ancestors'>ancestors</span>
  <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_goal'>goal</span>      <span class='op'>=</span> <span class='kw'>self</span>
  
  <span class='kw'>while</span> <span class='id identifier rubyid_goal'>goal</span>
    <span class='id identifier rubyid_ancestors'>ancestors</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span>
    <span class='id identifier rubyid_goal'>goal</span> <span class='op'>=</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_calling_goal'>calling_goal</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ancestry-instance_method">
  
    #<strong>ancestry</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A convenience method for testing/debugging.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the calling chain for this goal as a String.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93
94
95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 91</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ancestry'>ancestry</span>
  <span class='id identifier rubyid_indent'>indent</span> <span class='op'>=</span> <span class='op'>-</span><span class='int'>1</span>
  <span class='id identifier rubyid_ancestors'>ancestors</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
    <span class='id identifier rubyid_indent'>indent</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>  </span><span class='tstring_end'>&#39;</span></span> <span class='op'>*</span> <span class='id identifier rubyid_indent'>indent</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="check_deleted-instance_method">
  
    #<strong>check_deleted</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Determines whether the Goal has been deleted and removes its Variables and Values if it has.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether the Goal has been deleted</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133
134
135
136
137
138
139
140
141
142
143
144
145</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 131</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  
  <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
    <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_delete_if'>delete_if</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__name'>_name</span><span class='comma'>,</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_remove'>remove</span>
    <span class='kw'>true</span>
  <span class='kw'>end</span>
  
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete!-instance_method">
  
    #<strong>delete!</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Delete the Goal</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether the Goal has been deleted (memoized)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


118
119
120
121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 118</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete!'>delete!</span>
  <span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_deleted?'>deleted?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deleted?-instance_method">
  
    #<strong>deleted?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether the Goal has been deleted (memoized)</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether the Goal has been deleted (memoized)</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


124
125
126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 124</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deleted?'>deleted?</span>
  <span class='ivar'>@deleted</span> <span class='op'>||=</span> <span class='id identifier rubyid_check_deleted'>check_deleted</span>
  <span class='ivar'>@deleted</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inherit_variables-instance_method">
  
    #<strong>inherit_variables</strong>(other_goal = @calling_goal)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Inherits variables and their instantiations from another goal.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>other_goal</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>@calling_goal</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the Goal to inherit variables from.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether the variables could be inherited (unified).</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 325</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inherit_variables'>inherit_variables</span><span class='lparen'>(</span><span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='ivar'>@calling_goal</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_other_goal'>other_goal</span>
  
  <span class='id identifier rubyid_unified'>unified</span>      <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_variables'>variables</span>    <span class='op'>=</span> <span class='lparen'>(</span>
    <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span> <span class='op'>+</span>
    <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span> <span class='op'>+</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_arguments'>arguments</span><span class='period'>.</span><span class='id identifier rubyid_variables'>variables</span>
  <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:to_sym</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
  
  <span class='id identifier rubyid_variables'>variables</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='op'>|</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span>
    
    <span class='id identifier rubyid_unification'>unification</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_unify'><span class='object_link'><a href="../Porolog.html#unify-instance_method" title="Porolog#unify (method)">unify</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_unified'>unified</span>   <span class='op'>&amp;&amp;=</span> <span class='op'>!</span><span class='op'>!</span><span class='id identifier rubyid_unification'>unification</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
      <span class='id identifier rubyid_unifications'>unifications</span> <span class='op'>+=</span> <span class='id identifier rubyid_unification'>unification</span>
    <span class='kw'>else</span>
      <span class='comment'>#:nocov:
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Couldn&#39;t unify: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> WITH </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> AND </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>break</span>
      <span class='comment'>#:nocov:
</span>    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_unified'>unified</span> <span class='op'>&amp;&amp;=</span> <span class='const'><span class='object_link'><a href="../Porolog.html" title="Porolog (module)">Porolog</a></span></span><span class='op'>::</span><span class='id identifier rubyid_instantiate_unifications'><span class='object_link'><a href="../Porolog.html#instantiate_unifications-instance_method" title="Porolog#instantiate_unifications (method)">instantiate_unifications</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_unifications'>unifications</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_unified'>unified</span>
  
  <span class='id identifier rubyid_unified'>unified</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect-instance_method">
  
    #<strong>inspect</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns pretty representation.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pretty representation.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect'>inspect</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_myid'>myid</span><span class='embexpr_end'>}</span><span class='tstring_content'> -- </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_description'>description</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="inspect_variables-instance_method">
  
    #<strong>inspect_variables</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A convenience method for testing/debugging.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a tree representation of all the instantiations of this goal&#39;s variables.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 206</span>

<span class='kw'>def</span> <span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
  <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:inspect_with_instantiations</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="instantiate-instance_method">
  
    #<strong>instantiate</strong>(name, other, other_goal = self)  &#x21d2; <tt><span class='object_link'><a href="Instantiation.html" title="Porolog::Instantiation (class)">Porolog::Instantiation</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Instantiates a Variable to another Variable or Value, for this Goal.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></tt>, <tt><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Porolog::Variable</a></span></tt>, <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the name that references the variable to be instantiated.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>other</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the value that the variable is to be instantiated to.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>other_goal</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="" title="Porolog::Goal (class)">Porolog::Goal</a></span></tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>self</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the Goal of the other value.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Instantiation.html" title="Porolog::Instantiation (class)">Porolog::Instantiation</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the instantiation.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


310
311
312
313
314
315
316
317
318
319
320</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 310</span>

<span class='kw'>def</span> <span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_other'>other</span><span class='comma'>,</span> <span class='id identifier rubyid_other_goal'>other_goal</span> <span class='op'>=</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  
  <span class='id identifier rubyid_other'>other</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_other'>other</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span> <span class='op'>==</span> <span class='symbol'>:variable</span>
    <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_other_goal'>other_goal</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  
  <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_instantiate'>instantiate</span><span class='lparen'>(</span><span class='id identifier rubyid_other'>other</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="myid-instance_method">
  
    #<strong>myid</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A convenience method for testing/debugging.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the id of the goal.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 101</span>

<span class='kw'>def</span> <span class='id identifier rubyid_myid'>myid</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Goal</span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='cvar'>@@goals</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>-</span><span class='int'>1000</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='int'>1</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="satisfy-instance_method">
  
    #<strong>satisfy</strong>(&amp;block)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Solves the goal but not as the root goal for a query. That is, solves an intermediate goal.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>code to perform when the Goal is satisfied.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether the definition was satisfied.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


292
293
294
295
296
297
298
299
300
301
302
303</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 292</span>

<span class='kw'>def</span> <span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
  
  <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
  
  <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='op'>|</span>
    <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span> <span class='op'>=</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span><span class='id identifier rubyid_subgoal'>subgoal</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_satisfied'>satisfied</span> <span class='op'>||=</span> <span class='id identifier rubyid_subgoal_satisfied'>subgoal_satisfied</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_satisfied'>satisfied</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="solve-instance_method">
  
    #<strong>solve</strong>(max_solutions = nil)  &#x21d2; <tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;Hash{<span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span> =&gt; <span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span>}&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finds all possible solutions to the Predicate for the specific Arguments.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>max_solutions</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if provided, the search is stopped once the number of solutions has been found</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;Hash{<span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span> =&gt; <span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span>}&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 269</span>

<span class='kw'>def</span> <span class='id identifier rubyid_solve'>solve</span><span class='lparen'>(</span><span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>unless</span> <span class='ivar'>@arguments</span>
  
  <span class='id identifier rubyid_predicate'>predicate</span> <span class='op'>=</span> <span class='ivar'>@arguments</span><span class='period'>.</span><span class='id identifier rubyid_predicate'>predicate</span>
  
  <span class='id identifier rubyid_predicate'>predicate</span><span class='op'>&amp;.</span><span class='id identifier rubyid_satisfy'>satisfy</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_goal'>goal</span><span class='op'>|</span>
    <span class='comment'># TODO: Refactor to overrideable method (or another solution, say a lambda)
</span>    
    <span class='ivar'>@solutions</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_variables'>variables</span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SOLUTION: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_variables'>variables</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_ancestry'>ancestry</span>
    <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_goal'>goal</span><span class='period'>.</span><span class='id identifier rubyid_inspect_variables'>inspect_variables</span>
    
    <span class='kw'>return</span> <span class='ivar'>@solutions</span> <span class='kw'>if</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@solutions</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_max_solutions'>max_solutions</span>
  <span class='kw'>end</span>
  
  <span class='ivar'>@solutions</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="terminate!-instance_method">
  
    #<strong>terminate!</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sets that the goal should no longer search any further rules for the current predicate once the current rule has finished being evaluated. This method implements the :CUT rule. That is, backtracking does not go back past the point of the cut.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


152
153
154
155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 152</span>

<span class='kw'>def</span> <span class='id identifier rubyid_terminate!'>terminate!</span>
  <span class='ivar'>@log</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>terminating</span><span class='tstring_end'>&#39;</span></span>
  <span class='ivar'>@terminate</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="terminated?-instance_method">
  
    #<strong>terminated?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns whether the goal has been cut.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether the goal has been cut.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_terminated?'>terminated?</span>
  <span class='ivar'>@terminate</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="value-instance_method">
  
    #<strong>value</strong>(value)  &#x21d2; <tt><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Porolog::Value</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a Value, ensuring it has been associated with this Goal so that it can be uninstantiated.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the value that needs to be associated with this Goal.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Porolog::Value</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a Value, ensuring it has been associated with this Goal so that it can be uninstantiated.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


234
235
236
237</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 234</span>

<span class='kw'>def</span> <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
  <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Value.html#initialize-instance_method" title="Porolog::Value#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span>
  <span class='ivar'>@values</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="value_of-instance_method">
  
    #<strong>value_of</strong>(name, index = nil, visited = [])  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of the indicated variable or value</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></tt>, <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>name of the variable or value</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>index</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>index is not yet used</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>visited</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[]</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>used to avoid infinite recursion</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the value</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


244
245
246</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 244</span>

<span class='kw'>def</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_visited'>visited</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_visited'>visited</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="values-instance_method">
  
    #<strong>values</strong>  &#x21d2; <tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A convenience method for testing/debugging.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the values instantiated for this goal.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_values'>values</span>
  <span class='ivar'>@values</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:value</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="values_of-instance_method">
  
    #<strong>values_of</strong>(object)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt><sup>+</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the values of an Object.  For most objects, this will basically just be the object. For Arrays, an Array will be returned where the elements are the value of the elements.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>object</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the Object to find the values of.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>, <tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the value(s) of the object.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


252
253
254
255
256
257
258
259
260
261
262
263
264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 252</span>

<span class='kw'>def</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
      <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_values_of'>values_of</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
      <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
      <span class='comment'># TODO: This needs to splat outwards; in the meantime, it splats just the first.
</span>      <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_object'>object</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="variable-instance_method">
  
    #<strong>variable</strong>(name)  &#x21d2; <tt><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Porolog::Variable</a></span></tt>, <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finds or tries to create a variable in the goal (as much as possible) otherwise passes the parameter back.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>name</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>name of variable or variable</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Porolog::Variable</a></span></tt>, <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a variable of the goal or the original parameter</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


219
220
221
222
223
224
225
226
227
228
229
230</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 219</span>

<span class='kw'>def</span> <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_name'>name</span> <span class='kw'>unless</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
  
  <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_variable'>variable</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
    <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_variable'>variable</span> <span class='kw'>if</span> <span class='id identifier rubyid_variable'>variable</span><span class='period'>.</span><span class='id identifier rubyid_goal'>goal</span> <span class='op'>==</span> <span class='kw'>self</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_variable'>variable</span>
  <span class='kw'>end</span>
  
  <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Variable.html#initialize-instance_method" title="Porolog::Variable#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='kw'>self</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='ivar'>@variables</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="variables-instance_method">
  
    #<strong>variables</strong>  &#x21d2; <tt>Hash{<span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span> =&gt; <span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span>}</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the Variables and their current values of this Goal</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash{<span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span> =&gt; <span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span>}</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the Variables and their current values of this Goal</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


191
192
193
194
195
196
197
198
199
200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 191</span>

<span class='kw'>def</span> <span class='id identifier rubyid_variables'>variables</span>
  <span class='ivar'>@variables</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each_with_object'>each_with_object</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_variable'>variable</span><span class='comma'>,</span><span class='id identifier rubyid_variable_list'>variable_list</span><span class='op'>|</span>
    <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_value_of'>value_of</span><span class='lparen'>(</span><span class='id identifier rubyid_variable'>variable</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_clean'>clean</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_variable_list'>variable_list</span><span class='lbracket'>[</span><span class='id identifier rubyid_variable'>variable</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
    <span class='kw'>end</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="variablise-instance_method">
  
    #<strong>variablise</strong>(object)  &#x21d2; <tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='[]-instance_method'>[]</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Converts all embedded Symbols to Variables within this Goal.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>object</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the object to variablise.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the variablised object.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/porolog/goal.rb', line 165</span>

<span class='kw'>def</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Symbol.html" title="Symbol (class)">Symbol</a></span></span><span class='comma'>,</span><span class='const'><span class='object_link'><a href="Variable.html" title="Porolog::Variable (class)">Variable</a></span></span>
      <span class='id identifier rubyid_variable'>variable</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></span>
      <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_element'>element</span><span class='op'>|</span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_element'>element</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Arguments.html" title="Porolog::Arguments (class)">Arguments</a></span></span>
      <span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span>
      <span class='const'><span class='object_link'><a href="Tail.html" title="Porolog::Tail (class)">Tail</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Tail.html#initialize-instance_method" title="Porolog::Tail#initialize (method)">new</a></span></span> <span class='id identifier rubyid_variablise'>variablise</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'><span class='object_link'><a href="Value.html" title="Porolog::Value (class)">Value</a></span></span>
      <span class='id identifier rubyid_object'>object</span>
    <span class='kw'>when</span> <span class='const'>NilClass</span>
      <span class='kw'>nil</span>
    <span class='kw'>else</span>
      <span class='kw'>if</span> <span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_TAIL-constant" title="Porolog::UNKNOWN_TAIL (constant)">UNKNOWN_TAIL</a></span></span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../Porolog.html#UNKNOWN_ARRAY-constant" title="Porolog::UNKNOWN_ARRAY (constant)">UNKNOWN_ARRAY</a></span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_object'>object</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='id identifier rubyid_object'>object</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Aug 13 22:35:32 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.19 (ruby-2.6.5).
</div>

    </div>
  </body>
</html>